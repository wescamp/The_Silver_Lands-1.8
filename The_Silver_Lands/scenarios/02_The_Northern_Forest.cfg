#textdomain wesnoth-The_Silver_Lands

[scenario]
    id=02_The_Northern_Forest
    name= _ "The Northern Forest"
    {MAP 02_The_Northern_Forest.map}
    #{TURNS 42 38 36}
    turns=-1
    victory_when_enemies_defeated=no
    #Nothing to see here...
    #next_scenario=03_An_Icy_Paradise

    {STORYTXT_NORTHERN_FOREST}

    {ETERNAL_DARKNESS}
    {DEATHS_COMMON}

    {SCENARIO_MUSIC          "nunc_dimittis.ogg"      }
    {EX_EXTRA_SCENARIO_MUSIC "breaking_the_chains.ogg"}
    {EX_EXTRA_SCENARIO_MUSIC "elvish-theme.ogg"       }

    ###########################################################################################################
    #                         Events table (stuff that can be triggered with 'throw')                         #
    ###########################################################################################################
    # battle-setup : sets up all of the sides, units, et cetera used by the battle of this scenario           #
    # arrival-serqitum : moves the players to Sérqitum; triggers all of the dialogue, et cetera               #
    # quintus-death : turns Quintus into a Soulless                                                           #
    # shinsei-vanish : makes Shinseidesuki-Liminos teleport away, thus removing him from the scenario         #
    # shaxthal-setup : sets up the Shaxthal side and roaming sound effects                                    #
    # shaxthal-sps-setup: sets up the Shaxthal spawn points                                                   #
    # second-tears-sighting: triggers the dialogue/shroud removal when the ToF is seen for the second time    #
    # open-tomb-gates : opens the tomb's gates                                                                #
    # spawn-ghosts : spawns Tyurnio and friends in the tomb                                                   #
    # tyurnio-defeat : triggers some dialogue and the dropping of the pendant                                 #
    # victory : this should be self-explanatory...                                                            #
    ###########################################################################################################

    [side]
        side=1
        team_name=heroes
        user_team_name= _ "team_name^Heroes"
        controller=human
        type=Orcish Initiate
        id="Sorum'tar"
        name= _ "Sorum'tar"
        canrecruit=yes
        unrenamable=yes
        recruit=Brazier Creation,Vine Beast,Animated Rock,Tidal,Magic Servant,Razorbird,Wind Herder,Ethereal Orb
        shroud=yes
        fog=yes
        facing=ne
    [/side]

    [side]
        side=2
        team_name=shaxthals
        #user_team_name= _ "team_name^Shaxthals"
        hidden=yes
        controller=ai
        no_leader=yes
        recruit=Shaxthal Drone,Shaxthal Runner Drone
        colour={COLOR_CYAN}
        fog=no
        shroud=no
        income=0
        {GOLD 150 100 75}
        [ai]
            {ATTACK_DEPTH 2 2 3}
            passive_leader=yes
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
            village_value=0.1
            # I don't know if these will be used... so... yeahz...
            #[avoid]
            #    x,y=17-81,30-51
            #[/avoid]
            #{AI_TARGET (side=11) 1}
        [/ai]
    [/side]

    [side]
        side=3
        team_name=heroes
        #user_team_name= _ "team_name^Forest Guardians"
        hidden=yes
        controller=ai
        no_leader=yes
        recruit=Wose,Wose Sapling
        fog=yes
        shroud=yes
        income=0
        {GOLD 300 250 200}
        [ai]
            villages_per_scout=0
            {ATTACK_DEPTH 2 2 3}
            passive_leader=yes
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
            village_value=0.5
            [target]
                id=Mal Ameriälis
                value=10.0
            [/target]
            [protect]
                id=Moranku-Shirit
                value=7.0
            [/protect]
            #[avoid]
            #    x,y=20-81,35-51
            #[/avoid]
        [/ai]
    [/side]

    [side]
        side=4
        team_name=heroes
        #user_team_name= _ "team_name^Forest Guardians"
        hidden=yes
        controller=ai
        no_leader=yes
        recruit=Brazier Creation,Vine Beast,Animated Rock,Tidal,Magic Servant,Razorbird,Wind Herder
        fog=yes
        shroud=yes
        income=0
        {GOLD 300 250 200}
        [ai]
            {ATTACK_DEPTH 2 2 3}
            passive_leader=yes
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
            village_value=0.5
            [target]
                id=Mal Ameriälis
                value=10.0
            [/target]
            [protect]
                id=Moranku-Shirit
                value=7.0
            [/protect]
            #[avoid]
            #    x,y=20-81,35-51
            #[/avoid]
        [/ai]
    [/side]

    [side]
        side=5
        team_name=loyalists
        #user_team_name= _ "team_name^Loyalists"
        hidden=yes
        controller=ai
        no_leader=yes
        recruit=Chaos Invader,Chaos Invoker,Chaos Bowman,Chaos Gunner,Chaos Raider,Chaos Headhunter
        fog=yes
        shroud=yes
        income=0
        {CHAOS_FLAG}
        {GOLD 250 300 350}
        [ai]
            recruitment_pattern=scout,scout,fighter,archer,fighter,mixed fighter
            {ATTACK_DEPTH 2 2 3}
            passive_leader=yes
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
            village_value=0.5
        [/ai]
    [/side]

    [side]
        side=6
        team_name=loyalists
        #user_team_name= _ "team_name^Loyalists"
        hidden=yes
        controller=ai
        no_leader=yes
        recruit=Chaos Invader,Chaos Bowman,Chaos Gunner,Chaos Raider,Chaos Headhunter
        colour=blue
        fog=yes
        shroud=yes
        income=0
        {CHAOS_FLAG}
        {GOLD 250 300 350}
        [ai]
            recruitment_pattern=scout,scout,fighter,archer,archer,mixed fighter
            {ATTACK_DEPTH 2 2 3}
            passive_leader=yes
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
            village_value=0.5
        [/ai]
    [/side]

    [side]
        side=7
        team_name=loyalists
        #user_team_name= _ "team_name^Loyalists"
        hidden=yes
        controller=ai
        no_leader=yes
        colour=white
        recruit=Walking Corpse,Elvish Warrior Spirit,Ghoul,Skeleton,Skeleton Archer,Skeleton Rider,Dark Adept
        fog=no
        shroud=no
        income=0
        {CHAOS_FLAG}
        {GOLD 250 300 350}
        [ai]
            recruitment_pattern=scout,scout,scout,scout,fighter,fighter,archer
            passive_leader=yes
            {ATTACK_DEPTH 2 2 3}
            {QUANTITY leader_value (0.0) (0.2) (0.4)}
            caution=0.2
        [/ai]
    [/side]

    [side]
        side=8
        team_name=forest_denizens
        #user_team_name = _ "team_name^Forest Denizens"
        hidden=yes
        controller=ai
        no_leader=yes
        fog=no
        shroud=no
        colour=green
        [ai]
            # Unfriendly to all except for the Shaxthals
            #{AI_TARGET (side=1) 3}
            #{AI_TARGET (side=2) 1}
            #{AI_TARGET (side=3) 1}
            #{AI_TARGET (side=4) 1}
            #{AI_TARGET (side=5) 3}
            #{AI_TARGET (side=6) 3}
            #{AI_TARGET (side=7) 3}
            #{AI_TARGET (side=8) 3}
            #{AI_TARGET (side=9) 3}
            #{AI_TARGET (side=10) 1}
        [/ai]
    [/side]

    # Enemies spawned if the player chooses to do the sidequest
    [side]
        side=9
        team_name=elvish_spirits
        no_leader=yes
        fog=no
        shroud=no
        colour=black
        #user_team_name= _ "team_name^Wrathful Elvish Spirits"
        hidden=yes
        [ai]
            village_value=0.0
            aggression=1.0
            caution=-1.0
            grouping=defensive
            # They hate orcs
            [target]
                id="Sorum'tar"
                value=10.0
            [/target]
        [/ai]
    [/side]

    [event]
        name=prestart

        # Recall Tyramos
        {TYRAMOS_ATTEMPT_RECALL 21 49}

        # Scenery

        # Tears of the Forest sidequest related scenery

        # Place elvish statues

        # Along the road to the tomb
        [item]
            x,y=41,31
            image=scenery/hero-statue-e.png
        [/item]

        # Outside the tomb
        [item]
            x,y=54,28
            image=scenery/enchantress-statue-e-rotten.png
        [/item]

        [item]
            x,y=57,27
            image=scenery/enchantress-statue-e-rotten.png~FL()
        [/item]

        # Place the sarcophagus
        [item]
            x,y=59,32
            image=items/coffin-closed.png
        [/item]

        # Place the informational monolith
        [item]
            x,y=54,27
            image=scenery/monolith3.png~FL()
        [/item]

        # Place cairns that houses the spirits of Tyurnio's guarians
        [item]
            x,y=57,31
            image=scenery/rock-cairn.png
        [/item]

        [item]
            x,y=59,30
            image=scenery/rock-cairn.png
        [/item]

        [item]
            x,y=61,33
            image=scenery/rock-cairn.png
        [/item]

        # Loyalist scenery

        # Burials
        [item]
            x,y=25,11
            image=items/burial.png
        [/item]

        [item]
            x,y=38,5
            image=items/burial.png
        [/item]

        [item]
            x,y=41,14
            image=items/burial.png~FL()
        [/item]

        [item]
            x,y=51,14
            image=items/burial.png
        [/item]

        # Bonestacks
        [item]
            x,y=37,11
            image=items/bonestack.png
        [/item]

        [item]
            x,y=20,9
            image=items/bonestack.png
        [/item]

        [item]
            x,y=53,9
            image=items/bonestack.png
        [/item]

        [item]
            x,y=20,9
            image=items/bonestack.png
        [/item]

        [item]
            x,y=41,12
            image=items/bonestack.png
        [/item]

        # Bones
        [item]
            x,y=24,8
            image=items/bones.png
        [/item]

        [item]
            x,y=45,8
            image=items/bones.png
        [/item]

        [item]
            x,y=41,8
            image=items/bones.png
        [/item]

        [item]
            x,y=54,12
            image=items/bones.png
        [/item]

        [item]
            x,y=47,15
            image=items/bones.png
        [/item]

        # Barrels
        [item]
            x,y=26,5
            image=items/barrel.png
        [/item]

        [item]
            x,y=23,12
            image=items/barrel.png
        [/item]

        [item]
            x,y=52,10
            image=items/barrel.png
        [/item]

        [item]
            x,y=58,11
            image=items/barrel.png
        [/item]

        # Creek of Joy scenery

        # Place skeleton
        [item]
            x,y=6,38
            image=items/bones.png
        [/item]

        # Place the Tears of the Forest
        [unit]
            side=8
            id=TotF
            name= _ "Tears of the Forest"
            type=Tears of the Forest
            x,y=23,40
        [/unit]

        # Auditory ambience

        # Birds
        [sound_source]
            id=birds_one
            x,y=8,49
            sounds="ambient/birds1.ogg,ambient/birds2.ogg,ambient/birds3.ogg"
            delay=0
            chance=60
            full_range=15
            fade_range=10
            check_fogged=false
            check_shrouded=false
        [/sound_source]

        [sound_source]
            id=birds_two
            x,y=50,28
            sounds="ambient/birds1.ogg,ambient/birds2.ogg,ambient/birds3.ogg"
            delay=0
            chance=60
            full_range=13
            fade_range=7
            check_fogged=false
            check_shrouded=false
        [/sound_source]

        [sound_source]
            id=birds_three
            x,y=7,13
            sounds="ambient/birds1.ogg,ambient/birds2.ogg,ambient/birds3.ogg"
            delay=0
            chance=60
            full_range=5
            fade_range=15
            check_fogged=false
            check_shrouded=false
        [/sound_source]

        # Yay, Shaxthal sounds!
        [sound_source]
            id=shaxthals
            x,y=61,45
            sounds="ambient/shaxthal-roam-1.ogg,ambient/shaxthal-roam-2.ogg,shaxthal-die-1.ogg,shaxthal-die-2.ogg,shaxthal-die-3.ogg,shaxthal-die-4.ogg"
            delay=300
            chance=2
            full_range=7
            fade_range=15
            check_fogged=false
        [/sound_source]

        # Braziers

        # Outside of Tyurnio's tomb
        [sound_source]
            id=tomb_entrance_brazier_one
            x,y=54,29
            sounds="ambient/campfire.ogg"
            delay=0
            chance=100
            full_range=5
            fade_range=3
            check_fogged=true
        [/sound_source]

        [sound_source]
            id=tomb_entrance_brazier_two
            x,y=58,27
            sounds="ambient/campfire.ogg"
            delay=0
            chance=100
            full_range=5
            fade_range=3
            check_fogged=true
        [/sound_source]

        # Sérqitum...

        # Campfires
        [sound_source]
            id=campfire_one
            x,y=23,9
            sounds="ambient/campfire.ogg"
            delay=0
            chance=100
            full_range=6
            fade_range=4
            check_fogged=true
        [/sound_source]

        [sound_source]
            id=campfire_two
            x,y=37,8
            sounds="ambient/campfire.ogg"
            delay=0
            chance=100
            full_range=6
            fade_range=4
            check_fogged=true
        [/sound_source]

        [sound_source]
            id=campfire_three
            x,y=53,12
            sounds="ambient/campfire.ogg"
            delay=0
            chance=100
            full_range=6
            fade_range=4
            check_fogged=true
        [/sound_source]
    [/event]

    {TYRAMOS_1ST_TIME_HELP}

    # Signposts

    # Directional signpost
    {SIGNPOST 24 39 ( _ "North: Sérqitum
Northeast: The Tomb of Tyurnio
East: The Swamp of Eternal Misery (Keep Out)
West: Blessed Spring; Creek of Joy")}

    # Warning signpost
    {SIGNPOST 44 36 ( _ "WARNING! Do not enter the swamp, or you shall be devoured by its horrific denizens…

You have been warned.

Many people with the desire to end their lives have entered this swamp. Stop; do not enter; do not lose hope; life is worth living.")}

    # Start...
    [event]
        name=start

        # Starting dialogue
        [message]
            speaker="Sorum'tar"
            message= _ "Huh? Shouldn't Naia be greeting us by now? Also, what's up with this fog? This darkness and this fog is highly unnatural…"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "It would seem that this place has been cursed by a highly potent force."
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Regardless, we need to reach Sérqitum. However, we are not in a hurry, so, we have time to explore the forest…"
        [/message]

        [message]
            speaker="Sorum'tar"
            message= _ "All right then."
        [/message]

        # Yay, objectives
        [objectives]
            side=1
            [objective]
                description= _ "Explore the forest"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Sorum'tar"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tyramos"
                condition=lose
            [/objective]
            {OBJECTIVE_NOTES   ({NO_EARLY_FINISH_BONUS_NOTE} + {NEW_GOLD_CARRYOVER_NOTE_40})}
        [/objectives]
    [/event]

    # Blessed Spring explanation
    [event]
        name=moveto
        [filter]
            side=1
            [filter_location]
                terrain=*^Bls
            [/filter_location]
        [/filter]

        [message]
            speaker=unit
            message= _ "Wow, this water feels magnificent! It even feels like it is healing me!"
        [/message]

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "This a very rare and special type of spring. Its blessèd waters will heal your units by eight hitpoints per turn and cure poisoning."
        [/message]
    [/event]

    # Treasure at the Creek of Joy
    [event]
        name=moveto
        [filter]
            side=1
            x,y=6,38
        [/filter]

        [redraw]
            side=1
        [/redraw]

        [message]
            speaker=unit
            message= _ "Hmmm… a skeleton… Oh, there's a bottle with a piece of paper inside right next to it! *pop*"
        [/message]

        #po: This message block uses some stereotypical pirate talk, so, the use of 'me' instead of 'my' is intended.
        [message]
            speaker=narrator
            caption= _ "Journal Entry — Date: ?"
            message= _ "Har har har… although I am beat up pretty badly, I have escaped from the wretched king's soldiers. They'll never find me precious treasure, as I have buried it nearby, at the points of seven, thirty-seven. As long as that greedy bastard, the King of Wesnoth never finds it, I'll be able to rest in peace in this forest forevermore…

— Captian Nuram"
        [/message]

        [message]
            speaker=unit
            message= _ "Oooh, treasure! Maybe it hasn't been discovered yet!"
        [/message]

        # Place treasure
        [event]
            name=moveto
            [filter]
                side=1
                x,y=7,37
            [/filter]

            [message]
                speaker=unit
                message= _ "I think the treasure's here… OK, let's dig!"
            [/message]

            [delay]
                time=100
            [/delay]

            [item]
                x,y=7,37
                image=items/chest-plain-closed.png
            [/item]

            [redraw][/redraw]

            [message]
                speaker=unit
                message= _ "Ah, a chest! Let's open it!"
            [/message]

            [sound]
                name=open-chest.wav
            [/sound]

            [removeitem]
                x,y=7,37
            [/removeitem]

            [item]
                x,y=7,37
                image=items/chest-plain-open.png
            [/item]

            [redraw][/redraw]

            [sound]
                name=gold.ogg
            [/sound]

            [message]
                speaker=narrator
                image="items/gold-coins-medium.png"
                message= _ "You retrieve 300 pieces of gold."
            [/message]

            [gold]
                side=1
                amount=300
            [/gold]

            [message]
                speaker=unit
                message= _ "Wow! three hundred pieces of gold! Sorry for taking your precious treasure Captain Nuram, but it shall be put to good use. May you continue to rest in peace."
            [/message]
        [/event]
    [/event]

    # Shaxthals at the Swamp of Eternal Misery
    [event]
        name=moveto
        [filter]
            side=1
            x=44-66
            y=40-56
        [/filter]

        [fire_event]
            name=shaxthal-setup
        [/fire_event]
    [/event]

    # Shaxthal sighting
    [event]
        name=sighted
        [filter]
            race=shaxthal
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        {PLAY_RANDOM_SOUND ("ambient/shaxthal-roam-1.ogg,ambient/shaxthal-roam-2.ogg,shaxthal-die-1.ogg,shaxthal-die-2.ogg,shaxthal-die-3.ogg,shaxthal-die-4.ogg")}

        [message]
            speaker=unit
            message= _ "Kahtchhhhhhh!"
        [/message]

        [if]
            [not]
                [variable]
                    name=second_unit.race
                    equals=undead
                [/variable]
            [/not]

            [then]
                [message]
                    speaker=second_unit
                    message= _ "WHAT THE HELL IS THAT THING!"
                [/message]

                [message]
                    speaker=Tyramos
                    message= _ "Those horrific creatures are known as Shaxthals. We should leave the swamp due to their dreadful power."
                [/message]
            [/then]

            [else]
                [message]
                    speaker=second_unit
                    message= _ "Oh no, there are Shaxthals in this swamp! We must leave at once!"
                [/message]
            [/else]
        [/if]

        # Setup Shaxthal spawnpoints
        [fire_event]
            name=shaxthal-sps-setup
        [/fire_event]

        [message]
            speaker=second_unit
            message= _ "Damn it, it's an ambush!"
        [/message]
    [/event]

    # wmllint: recognize Runitukis

    # Runitukis' death event
    [event]
        name=last breath
        [filter]
            id=Runitukis
        [/filter]

        [message]
            speaker=unit
            message= _ "Tchhhhhhhhhhhh… Chrrrrrr… *gurgle*"
        [/message]

        [message]
            speaker=unit
            message= _ "*vomits*"
        [/message]

        [message]
            speaker=second_unit
            message= _ "Ugh, disgusting… Eh? What's that shiny stuff?"
        [/message]

        [sound]
            name=gold.ogg
        [/sound]

        [message]
            speaker=narrator
            image="items/gold-coins-medium.png"
            message= _ "You retrieve 200 pieces of gold."
        [/message]

        [gold]
            side=1
            amount=200
        [/gold]

        [message]
            speaker=second_unit
            message= _ "Wow, two hundred pieces of gold! And… a key?"
        [/message]

        # A key variable that shall be used God-knows-when
        [set_variable]
            name=possess_vomited_key
            value=true
        [/set_variable]
    [/event]

    # Tears of the Forest sidequest

    # First sighting
    [event]
        name=sighted
        [filter]
            id=TotF
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [sound]
            name=wail.wav
        [/sound]

        [scroll_to]
            x=$x1
            y=$y1
        [/scroll_to]

        # Remove the shroud around the tears' hex
        [remove_shroud]
            side=1
            x=$x1
            y=$y1
            radius=2
        [/remove_shroud]

        [redraw]
            side=1
        [/redraw]

        [if]
            [not]
                [variable]
                    name=second_unit.race
                    equals=undead
                [/variable]
            [/not]

            [then]
                [message]
                    speaker=second_unit
                    message= _ "What is that glowing thingy?"
                [/message]

                [message]
                    speaker=Tyramos
                    message= _ "That is the phenomenon known as the 'Tears of the Forest.' It is essentially one of many manifestations of the forest's sadness. The manifestations generally appear whenever there is a restless, miserable, or hate-filled spirit present or if something devastating happened to the forest."
                [/message]
            [/then]

            [else]
                [message]
                    speaker=second_unit
                    message= _ "Ah, it would appear that the forest is sad…"
                [/message]

                [message]
                    speaker="Sorum'tar"
                    message= _ "Uh, what?"
                [/message]

                [message]
                    speaker=second_unit
                    message= _ "This glowing orb is known as the 'Tears of the Forest.' The reason that it bears such a name is due to the fact that it is essentially a manifestation of the forest's sadness. These generally appear whenever there is a restless, miserable, or hate-filled spirit present or if something devastating happened to the forest."
                [/message]

                [message]
                    speaker="Sorum'tar"
                    message= _ "Uh huh… I see…"
                [/message]

                [message]
                    speaker=second_unit
                    message= _ "I see that your lack of interest in these things still lingers… "
                [/message]
            [/else]
        [/if]

        # Move the tears to the tomb
        {MOVE_UNIT (id=TotF) 52 26}

        [message]
            speaker=Tyramos
            message= _ "Hmmm… It went down that road… I think that it wants us to follow it; I could hear it muttering 'to the tomb… to the tomb…'"
        [/message]

        [set_variable]
            name=sighted_tears
            value=true
        [/set_variable]
    [/event]

    # Second and final sighting of the tears
    [event]
        name=sighted
        first_time_only=no
        [filter]
            id=TotF
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [if]
            [variable]
                name=sighted_tears
                boolean_equals=true
            [/variable]

            [then]
                [fire_event]
                    name=second-tears-sighting
                    [primary_unit]
                        id=$unit.id
                    [/primary_unit]
                    [secondary_unit]
                        id=$second_unit.id
                    [/secondary_unit]
                [/fire_event]
            [/then]
        [/if]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=54,27
        [/filter]

        [redraw]
            side=1
        [/redraw]

        [if]
            [variable]
                name=tears_in_tomb
                boolean_equals=true
            [/variable]

            [then]
                [message]
                    speaker=narrator
                    image="scenery/monolith3.png~FL()"
                    message= _ "Concern yourself not with entering this tomb, but with profaning it. Nonetheless, choose your own path; make your own decisions."
                [/message]

                {ITEM_TOUCHPLATE 56 28}

                [redraw]
                    side=1
                [/redraw]

                [message]
                    speaker="Sorum'tar"
                    message= _ "That glowing yellow circle is beckoning us… Something must be waiting for us inside of the tomb…"
                [/message]

                [set_variable]
                    name=touchplate_appeared
                    value=true
                [/set_variable]

                # Clear variable
                [clear_variable]
                    name=tears_in_tomb
                [/clear_variable]
            [/then]
        [/if]
    [/event]

    # Open the gates!
    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=1
            x,y=56,28
        [/filter]

        [if]
            [variable]
                name=touchplate_appeared
                boolean_equals=true
            [/variable]

            [then]
                [if]
                    [variable]
                        name=unit.race
                        equals=orc
                    [/variable]

                    [then]
                        [fire_event]
                            name=open-tomb-gates
                        [/fire_event]

                        # Clear the variable, so that this event cannot occur again
                        [clear_variable]
                            name=touchplate_appeared
                        [/clear_variable]
                    [/then]

                    [else]
                        [message]
                            speaker=unit
                            message= _ "Nothing happened… Why don't you try opening it, Sorum'tar?"
                        [/message]
                    [/else]
                [/if]
            [/then]
        [/if]
    [/event]

    # Spawn Tyurnio and friends when Sorum'tar crosses the cairns
    [event]
        name=moveto
        [filter]
            side=1
            x=57-62
            y=30-34
            [not]
                x,y=57,30
            [/not]
            race=orc
            [filter_location]
                terrain=Rp,*^Bzu,*^Ii
            [/filter_location]
        [/filter]

        [fire_event]
            name=spawn-ghosts
        [/fire_event]
    [/event]

    # Tyurnio's death event

    [event]
        name=last breath
        [filter]
            id=Tyurnio
        [/filter]

        [fire_event]
            name=tyurnio-defeat
        [/fire_event]
    [/event]

    # If someone other than Sorum'tar or Tyramos tries to open the gate
    [event]
        name=moveto
        [filter]
            side=1
            x,y=23-24,29-30
            [not]
                id="Sorum'tar"
                [or]
                    id=Tyramos
                [/or]
            [/not]
        [/filter]

        #po: Second-person informal is being used to make the gatekeeper sound high and mighty.
        [message]
            speaker=narrator
            caption= _ "Gate Keeper"
            message= _ "Thou art not worthy enough to open this gate!"
        [/message]

        [message]
            speaker=unit
            message= _ "…"
        [/message]
    [/event]

    # The event that sets up the action
    [event]
        name=moveto
        [filter]
            side=1
            x,y=23-24,29-30
            id="Sorum'tar"
            [or]
                side=1
                x,y=23-24,29-30
                id=Tyramos
            [/or]
        [/filter]

        [fire_event]
            name=battle-setup
        [/fire_event]

        [fire_event]
            name=arrival-serqitum
        [/fire_event]
    [/event]

    # The witnessing of the power of guns...
    [event]
        name=attacker hits
        [filter_attack]
            name=gun
        [/filter_attack]

        [message]
            speaker="Sorum'tar"
            message= _ "What the hell was that!"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Those… things were used in the attack against us… Their appearence and function are similar to that of the thundersticks used by the Dwarves, but these are far deadlier."
        [/message]

        [message]
            speaker="Sorum'tar"
            message= _ "…"
        [/message]
    [/event]

    # Death events

    # Shinsei's "death" event
    [event]
        name=last breath
        [filter]
            id=Shinseidesuki-Liminos
        [/filter]

        [fire_event]
            name=shinsei-vanish
        [/fire_event]
    [/event]

    # Moranku-Shirit's death event
    [event]
        name=last breath
        [filter]
            id=Moranku-Shirit
        [/filter]

        [message]
            speaker=Moranku-Shirit
            message= _ "Ugh, those scumbags have defeated me!"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "How could we have allowed this to happen?"
        [/message]

        [redraw][/redraw]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    # Minor deaths

    # Gruntís-Sorum's death
    [event]
        name=last breath
        [filter]
            id=Gruntís-Sorum
        [/filter]

        [if]
            [have_unit]
                id=Shinseidesuki-Liminos
            [/have_unit]

            [then]
                [message]
                    speaker=unit
                    message= _ "I am terribly sorry Master Liminos, Lord Shirit, orc, ghostly one… I have failed… Good… luck…"
                [/message]
            [/then]

            [else]
                [message]
                    speaker=unit
                    message= _ "I am terribly sorry Lord Shirit, orc, ghostly one… I have failed… If any of you ever find Master Liminos, tell him that I am grateful for all that he has done… Good… luck…"
                [/message]
            [/else]
        [/if]
    [/event]

    # Quintus' death
    [event]
        name=last breath
        [filter]
            id=Quintus
        [/filter]

        [fire_event]
            name=quintus-death
        [/fire_event]
    [/event]

    # Qunet's death
    [event]
        name=last breath
        [filter]
            id=Qunet
        [/filter]

        [message]
            speaker=unit
            message= _ "Ugh… I… am… terribly sorry… milady… Please smite… them… for the three of us…"
        [/message]

        [message]
            speaker=Mal Ameriälis
            message= _ "*sigh*"
        [/message]
    [/event]

    # Miqush's death
    [event]
        name=last breath
        [filter]
            id=Miqush
        [/filter]

        [message]
            speaker=unit
            message= _ "Milady, I'm sorry… Please make sure that the operation suceeds… for the three of us…"
        [/message]

        [message]
            speaker=Mal Ameriälis
            message= _ "*sigh*"
        [/message]
    [/event]

    # Time out
    [event]
        name=time over

        [message]
            speaker=narrator
            message= _ "You hear the constant clanking of armor and see smoke in the distance."
        [/message]

        [message]
            speaker=Mal Ameriälis
            message= _ "Muahahahahahah! Reinforcements are very close! All of you might as well give up!"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Oh no, we are surely doomed!"
        [/message]
    [/event]

    # Mal Ameriälis' death; victory trigger
    [event]
        name=last breath
        [filter]
            id=Mal Ameriälis
        [/filter]

        [fire_event]
            name=victory
            [primary_unit]
                id=$unit.id
            [/primary_unit]
            [secondary_unit]
                id=$second_unit.id
            [/secondary_unit]
        [/fire_event]
    [/event]

    ######################################################################################
    # Custom; (mostly) huge events used by [fire_event] and the awesome 'throw' command  #
    ######################################################################################

    ###########################################
    #      Sérqitum; battle stuff             #
    ###########################################
    [event]
        name=battle-setup

        # Spawn leaders

        [unit]
            id=Moranku-Shirit
            name= _ "Moranku-Shirit"
            type=Ancient Wose
            x,y=29,22
            side=3
            canrecruit=yes
        [/unit]

        [unit]
            id=Shinseidesuki-Liminos
            name= _ "Shinseidesuki-Liminos"
            type=Wose Magister
            x,y=29,21
            side=4
            canrecruit=yes
            overlays=misc/leader-expendable.png
        [/unit]

        [unit]
            id=Qunet
            name= _ "Qunet"
            type=Dark Knight
            x,y=23,6
            side=5
            canrecruit=yes
            [modifications]
                {TRAIT_STRONG}
                {TRAIT_RESILIENT}
            [/modifications]
        [/unit]

        [unit]
            id=Miqush
            name= _ "Miqush"
            type=Chaos Longbowman
            x,y=56,10
            side=6
            canrecruit=yes
            facing=sw
            [modifications]
                {TRAIT_DEXTROUS}
                {TRAIT_QUICK}
            [/modifications]
        [/unit]

        [unit]
            id=Mal Ameriälis
            name= _ "Mal Ameriälis"
            type=Lich
            x,y=41,6
            side=7
            canrecruit=yes
            facing=sw
            [modifications]
                {TRAIT_DEXTROUS}
            [/modifications]
        [/unit]

        # Give the appropriate villages to the appropriate leaders
        {CAPTURE_VILLAGES 3 40 20  6}
        {CAPTURE_VILLAGES 3 18 23  5}

        {CAPTURE_VILLAGES 5 23 9   4}
        {CAPTURE_VILLAGES 6 53 12  3}
        {CAPTURE_VILLAGES 7 37 8   4}

        # Welcoming Wose
        [unit]
            id=Gruntís-Sorum
            name= _ "Gruntís-Sorum"
            type=Wose Shaman
            x,y=22,27
            side=4
            [modifications]
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        # Chaos unit at the castle
        [unit]
            id=Quintus
            name= _ "Quintus"
            type=Chaos Cavalier
            x,y=29,20
            facing=sw
            side=5
        [/unit]

        # Citizens of Sérqitum

        # Elemental guards

        # North side; dirt path to ford
        [unit]
            id=Dotakufi
            name= _ "Dotakufi"
            type=Rock Golem
            x,y=27,13
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Dotakufo
            name= _ "Dotakufo"
            type=Rock Golem
            x,y=28,13
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        # East gate
        [unit]
            id=Dotakuko
            name= _ "Dotakuko"
            type=Rock Golem
            x,y=14,20
            facing=nw
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Dotakuki
            name= _ "Dotakuki"
            type=Rock Golem
            x,y=15,19
            facing=nw
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        # West gate
        [unit]
            id=Dotakudo
            name= _ "Dotakudo"
            type=Rock Golem
            x,y=47,19
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Dotakudi
            name= _ "Dotakudi"
            type=Rock Golem
            x,y=48,19
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        # In the lake/palace area thingy
        [unit]
            id=Suitō
            name= _ "Suitō"
            type=Undine
            x,y=35,20
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Suitsu
            name= _ "Suitsu"
            type=Undine
            x,y=25,16
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Suijō
            name= _ "Suijō"
            type=Undine
            x,y=40,17
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]

        [unit]
            id=Suina
            name= _ "Suina"
            type=Undine
            x,y=34,24
            facing=ne
            side=4
            ai_special=guardian
            upkeep=loyal
            random_traits=yes
        [/unit]
    [/event]

    # Opening of Sérqitum's gates; arrival
    [event]
        name=arrival-serqitum

        # Remove fake shroud...
        [terrain_mask]
            x=1
            y=1
            border=yes
            {MASK 02_The_Northern_Forest_No_FS.mask}
        [/terrain_mask]

        # Open the gate
        [terrain]
            x,y=23,29
            terrain=Rp
        [/terrain]

        # Remove the shroud around the welcoming Wose
        [remove_shroud]
            x=21-25
            y=25-28
        [/remove_shroud]

        [redraw][/redraw]

        # Move the important people to the welcoming Wose
        {MOVE_UNIT (id=Sorum'tar) 22 28}
        {MOVE_UNIT (id=Tyramos)   23 28}

        # Yay, dialogue
        [message]
            speaker=Gruntís-Sorum
            message= _ "Welcome to Sérqitum. Master Liminos and Lord Shirit have been expecting you."
        [/message]

        {PLAY_RANDOM_SOUND ("magic-holy-1.ogg,magic-holy-2.ogg,magic-holy-3.ogg,magic-holy-4.ogg")}

        [message]
            speaker=narrator
            caption= _ "?"
            image=units/unknown-unit.png~RC(magenta>purple)
            message= _ "You, get out of here and never come back again! We shall never join your demonic organization!"
        [/message]

        [message]
            speaker=Gruntís-Sorum
            message= _ "Ugh… not again…"
        [/message]

        [message]
            speaker=Gruntís-Sorum
            message= _ "Please follow me…"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Very well."
        [/message]

        # Move them to the castle
        {MOVE_UNIT (id=Gruntís-Sorum) 28 21}
        {MOVE_UNIT (id=Sorum'tar)     28 22}
        {MOVE_UNIT (id=Tyramos)       30 22}

        {SET_FACING (id=Gruntís-Sorum) ne}
        {SET_FACING (id=Sorum'tar)     ne}
        {SET_FACING (id=Tyramos)       nw}

        # Remove the shroud in the castle
        [remove_shroud]
            x=25-33
            y=18-26
        [/remove_shroud]

        [redraw]
            side=1
        [/redraw]

        [message]
            speaker=Quintus
            message= _ "Fine, don't join our supreme organization, but, keep in mind that those who don't join us shall die by our sublime hand! Hahahahahahahahaha!"
        [/message]

        [message]
            speaker=Moranku-Shirit
            message= _ "*sigh*"
        [/message]

        #po: The reason that second-person informal (i.e., thou, shalt, sawest) is being used is to make it 'obvious' that Shinsei is being disrespectful towards the Chaos follower, not necessarily for archaic lulz.
        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Leave now… or thou shalt be fried! Thou sawest my grand capabilities!"
        [/message]

        [message]
            speaker=Quintus
            message= _ "Eeeek!"
        [/message]

        [sound]
            name=horse-canter.wav
        [/sound]

        # Move Quintus back to his little loyalist hideaway
        {MOVE_UNIT (id=Quintus) 25 8}
        {SET_FACING (id=Quintus) sw}

        # Moar dialogue...
        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "HA!"
        [/message]

        [message]
            speaker=Gruntís-Sorum
            message= _ "Uh, Master Liminos; Lord Shirit, our guests have arrived…"
        [/message]

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Eh?"
        [/message]

        # Put the important Woses into conversation mode
        {SET_FACING (id=Shinseidesuki-Liminos) sw}
        {SET_FACING (id=Moranku-Shirit)        sw}

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Oh, hello there, Tyramos; Sorum'tar…"
        [/message]

        [message]
            speaker="Sorum'tar"
            message= _ "…"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Hello Shinsei. What was all of that?"
        [/message]

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "That was one of the Loyalists' messengers… They have this crazy idea that anyone would join their pathetic shell of a former empire. They even think that burning portions of the forest will make us join or surrender."
        [/message]

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Little do they know, the very forest itself would rather perish than to tolerate the mere presence of those vulgar fanat—"
        [/message]

        [message]
            speaker=narrator
            image=units/unknown-unit.png~RC(magenta>white)
            message= _ "Oh, so we're merely a shell of a former empire? A mere cleanup crew could deal with the likes of you!"
        [/message]

        # Put teh characters into searching mode
        {SET_FACING (id=Moranku-Shirit)        ne}
        {SET_FACING (id=Shinseidesuki-Liminos) ne}
        #{SET_FACING (id=Gruntís-Sorum)         ne}

        [delay]
            time=300
        [/delay]

        #po: Again, second-person informal is being used to be insulting.
        [message]
            speaker=Moranku-Shirit
            message= _ "Who is there? Showest thy presence!"
        [/message]

        # Mal Ameriälis makes her grand appearence...
        [sound]
            name=lightning.ogg
        [/sound]

        [unit]
            side=7
            # MAAP = Mal Ameriälis' Astral Projection
            id=MAAP
            name= _ "Mal Ameriälis"
            type=Lich Astral Projection
            x,y=29,19
            overlays=misc/leader-crown.png
            facing=sw
        [/unit]

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Well, the witch has finally decided to reveal herself!"
        [/message]

        [message]
            speaker=MAAP
            message= _ "… Enough with this! All of you are either going to surrender or we shall smite all of you!"
        [/message]

        [message]
            speaker=Moranku-Shirit
            message= _ "For the last damn time, we are never going to join or surrender to the likes of thee!"
        [/message]

        [message]
            speaker=MAAP
            message= _ "Very well… You have just entered a war that you can never win!"
        [/message]

        [sound]
            name=lightning.ogg
        [/sound]

        [kill]
            id=MAAP
        [/kill]

        # Back to talking mode...
        {SET_FACING (id=Moranku-Shirit)        sw}
        {SET_FACING (id=Shinseidesuki-Liminos) sw}
        #{SET_FACING (id=Gruntís-Sorum)         ne}

        # Moar dialogue
        [message]
            speaker=Moranku-Shirit
            message= _ "Well, we ought to prepare for a long battle…"
        [/message]

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "I shall go up the road and disrupt the advancement of their forces…"
        [/message]

        # Move Shinsei to his summoning circle
        {MOVE_UNIT (id=Shinseidesuki-Liminos) 28 11}

        # Move Gruntís somewhere nearby...

        # Yay, even moar dialogue
        [message]
            speaker=Moranku-Shirit
            message= _ "There is a keep in the northwestern section of the city… Good luck…"
        [/message]

        [message]
            speaker=Moranku-Shirit
            message= _ "*sigh*"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "All right then, good luck…"
        [/message]

        # Remove the shroud around the castle
        [remove_shroud]
            x,y=22,18
            radius=2
        [/remove_shroud]

        # Yay...

        [redraw]
            side=1
        [/redraw]

        # Move Sorum'tar and Tyramos to teh castle
        {MOVE_UNIT  (id=Sorum'tar) 22 18}
        {SET_FACING (id=Sorum'tar)    ne}
        {MOVE_UNIT  (id=Tyramos)   20 19}
        {SET_FACING (id=Tyramos)      ne}

        [redraw]
            side=1
        [/redraw]

        # Put Shirit in sighting mode...
        {SET_FACING (id=Moranku-Shirit) ne}

        # Assign villages to side one
        {CAPTURE_VILLAGES 1 17 16 3}

        [capture_village]
            side=1
            x,y=10,18
        [/capture_village]

        # Remove the shroud into Sérqitum
        [remove_shroud]
            x=13-48
            y=15-27
        [/remove_shroud]

        [redraw]
            side=1
        [/redraw]

        # 'Tis not possible to set the current turn number to a lesser value... so... yeahz...
        # Set variable for number of turns
        # A variable is needed so that a string that mentions the number of turns
        # will be translatable
        #[set_variable]
        #    name=turn_limit
        #    value={DIFF 43 38 36}
        #[/set_variable]

        # Set turn limit
        #[modify_turns]
        #    current=1
        #    value=$turn_limit
        #[/modify_turns]

        # Objectives
        [objectives]
            side=1
            [objective]
                description= _ "Defeat Mal Ameriälis"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Sorum'tar"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tyramos"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Moranku-Shirit"
                condition=lose
            [/objective]
            {OBJECTIVE_NOTES   ({NO_EARLY_FINISH_BONUS_NOTE} + {NEW_GOLD_CARRYOVER_NOTE_40})}
            # TODO: Add {OBJECTIVE_NOTE (_ "There is now a limit of $turn_limit turns.")} to the line above once it is possible
            # to set the curent turn number to a lesser value.
        [/objectives]

        # Change the music...
        [music]
            name=the_city_falls.ogg
            immediate=yes
            append=no
        [/music]
        [music]
            name=legends_of_the_north.ogg
            append=yes
            ms_before=12000
        [/music]
        [music]
            name=heroes_rite.ogg
            append=yes
            ms_before=12000
        [/music]
    [/event]

    ######################################################
    #               Special deaths                       #
    ######################################################
    # Quintus' death event
    [event]
        name=quintus-death

        [message]
            speaker=Quintus
            message= _ "Damn it… if only I had another chance…"
        [/message]

        [message]
            speaker=Mal Ameriälis
            message= _ "*smiles creepily* Heh…"
        [/message]

        # LOL, he wanted another chance...
        [store_unit]
            variable=qstore
            [filter]
                id=Quintus
            [/filter]
        [/store_unit]

        [kill]
            id=Quintus
            animate=yes
        [/kill]

        [redraw][/redraw]

        [delay]
            time=500
        [/delay]

        [unit]
            id=Quintus
            name= _ "Quintus"
            type=Soulless
            x=$qstore.x
            y=$qstore.y
            facing=$qstore.facing
            variation=mounted
            side=7
            attacks_left=0
            moves=0
            resting=no
            animated=yes
            [modifications]
                {TRAIT_UNDEAD}
                {TRAIT_FEARLESS}
                {TRAIT_LOYAL}
            [/modifications]
        [/unit]

        [sound]
            name=zombie-attack.wav
        [/sound]

        [clear_variable]
            name=qstore
        [/clear_variable]
    [/event]

    # Shinseidesuki-Liminos' disappearing act
    [event]
        name=shinsei-vanish

        [message]
            speaker=Shinseidesuki-Liminos
            message= _ "Ugh…"
        [/message]

        # A disappearing act...
        {PLAY_RANDOM_SOUND ("magic-holy-1.ogg,magic-holy-2.ogg,magic-holy-3.ogg,magic-holy-4.ogg")}

        [redraw][/redraw]

        [kill]
            id=Shinseidesuki-Liminos
        [/kill]

        [message]
            speaker="Sorum'tar"
            message= _ "No, Magister Liminos!"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "Do not worry about him; he merely teleported to a safe location…"
        [/message]

        [message]
            speaker="Sorum'tar"
            message= _ "I see…"
        [/message]
    [/event]

    ######################################
    #        Swamp of Misery stuff       #
    ######################################

    # Shaxthal side, et cetera setup
    [event]
        name=shaxthal-setup

        {PLAY_RANDOM_SOUND ("ambient/shaxthal-roam-1.ogg,ambient/shaxthal-roam-2.ogg,shaxthal-die-1.ogg,shaxthal-die-2.ogg,shaxthal-die-3.ogg,shaxthal-die-4.ogg")}

        [message]
            speaker=unit
            message= _ "Huh? What was that sound?"
        [/message]

        # Spawn Shaxthal leader
        [unit]
            side=2
            type=Shaxthal Sentry Drone
            id=Runitukis
            name= _ "Runitukis"
            canrecruit=yes
            unrenamable=yes
            facing=nw
            x,y=59,52
            [modifications]
                {TRAIT_BIOMECHANICAL}
                {TRAIT_ARMORED}
            [/modifications]
        [/unit]

        {SETUP_SHAXTHAL_ROAMING_SOUND_EFFECTS}
    [/event]

    # Shaxthal spawn points setup
    [event]
        name=shaxthal-sps-setup

        # Spawn Shaxthal guards... muhahahahahah!
        # First set of parentheses, easy.
        # Second set, normal.
        # Third set, hard.
#ifdef EASY
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 49 46 no 1 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 56 48 no 1 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 53 49 yes 6 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 57 47 yes 6 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Drone") 2 52 41 yes 3 (yes)}
#endif

#ifdef NORMAL
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 49 46 no 1 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 56 48 no 1 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 53 49 yes 4 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 57 47 yes 4 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Drone") 2 52 41 yes 2 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Runner Drone") 2 54 52 no 1 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Runner Drone") 2 58 49 no 1 (yes)}
#endif

#ifdef HARD
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 49 46 yes 5 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 56 48 yes 5(yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 53 49 yes 3 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Wyrm") 2 57 47 yes 3 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Drone") 2 52 41 yes 2 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Runner Drone") 2 54 52 yes 2 (yes)}
        {PUT_HIVE_SPAWN_POINT ("Shaxthal Runner Drone") 2 58 49 yes 2 (yes)}
#endif

        [redraw]
            side=1
        [/redraw]
    [/event]

    #######################################
    #     Tears of the Forest stuff       #
    #######################################

    # Second tears sighting
    [event]
        name=second-tears-sighting

        [sound]
            name=wail.wav
        [/sound]

        [scroll_to]
            x=$x1
            y=$y1
        [/scroll_to]

        # Remove the shroud around the tears
        [remove_shroud]
            x=$x1
            y=$y1
            radius=2
        [/remove_shroud]

        # Remove the shroud around the tomb entrance
        [remove_shroud]
            side=1
            x=53-58
            y=26-29
        [/remove_shroud]

        [redraw]
            side=1
        [/redraw]

        [message]
            speaker=second_unit
            message= _ "There it is!"
        [/message]

        {MOVE_UNIT (id=TotF) 54 27}

        [sound]
            name=wail.wav
        [/sound]

        [message]
            speaker=second_unit
            message= _ "I think that it wants us to read the monolith."
        [/message]

        {MOVE_UNIT (id=TotF) 58 31}

        [kill]
            id=TotF
        [/kill]

        [sound]
            name=wail.wav
        [/sound]

        [set_variable]
            name=tears_in_tomb
            value=true
        [/set_variable]
    [/event]

    # Open tomb gates
    [event]
        name=open-tomb-gates

        # Remove touchplate
        [removeitem]
            x,y=56,28
        [/removeitem]

        # Open the gates...
        [terrain]
            x=55
            y=30
            terrain=Rp
        [/terrain]

        [terrain]
            x=56
            y=29
            terrain=Rp
        [/terrain]

        [terrain]
            x=57
            y=29
            terrain=Rp
        [/terrain]

        [terrain]
            x=58
            y=28
            terrain=Rp
        [/terrain]

        [redraw][/redraw]

        [message]
            speaker="Sorum'tar"
            message= _ "…"
        [/message]

        [message]
            speaker=Tyramos
            message= _ "And so they have opened…"
        [/message]
    [/event]

    # Ghost-spawining event
    [event]
        name=spawn-ghosts

        [scroll_to]
            x,y=59,32
        [/scroll_to]

        # Light all of the braziers... ooh... spooky
        [terrain]
            x,y=56,30
            terrain=Rp^Bz
        [/terrain]

        [terrain]
            x,y=59,29
            terrain=Rp^Bz
        [/terrain]

        [terrain]
            x,y=57,33
            terrain=Rp^Bz
        [/terrain]

        [terrain]
            x,y=61,31
            terrain=Rp^Bz
        [/terrain]

        [terrain]
            x,y=60,34
            terrain=Rp^Bz
        [/terrain]

        [terrain]
            x,y=62,32
            terrain=Rp^Bz
        [/terrain]

        [redraw][/redraw]

        [sound]
            name=torch.ogg
        [/sound]

        [message]
            speaker=unit
            message= _ "Huh?"
        [/message]

        [sound]
            name=wail.wav
        [/sound]

        [unit]
            id=Tyurnio
            name= _ "Tyurnio"
            type=Elvish Forefather
            side=9
            x,y=59,32
            facing=nw
            unrenamable=yes
            canrecruit=yes
            [modifications]
                {TRAIT_STRONG}
            [/modifications]
        [/unit]

        [message]
            speaker="Sorum'tar"
            message= _ "An elf?"
        [/message]

        [message]
            speaker=Tyurnio
            message= _ "Who dares to disturb my rest?"
        [/message]

        [message]
            speaker="Sorum'tar"
            message= _ "…"
        [/message]

        [message]
            speaker=Tyurnio
            message= _ "I, Tyrunio, one of the past rulers of Sérqitum, and by extension, one of the past rulers of this forest should not have to deal with this ever again! Vile orc, your ancestors have disturbed and slaughtered my people for centuries… I shall not accept your presence in my tomb."
        [/message]

        [message]
            speaker=Tyurnio
            message= _ "Due to the sins that you bear, you shall perish! GUARDS!"
        [/message]

        # Spawn the guards
        [sound]
            name=wail.wav
        [/sound]

        [unit]
            id=Galés
            name= _ "Galés"
            type={DIFF (Elvish Warrior Spirit) (Elvish Warrior Spirit) (Elvish Ancestor)}
            side=9
            x,y=57,31
            facing=se
            unrenamable=yes
        [/unit]

        [redraw][/redraw]

        [delay]
            time=300
        [/delay]

        [sound]
            name=wail.wav
        [/sound]

        [unit]
            id=Landor
            name= _ "Landor"
            type={DIFF (Elvish Warrior Spirit) (Elvish Warrior Spirit) (Elvish Ancestor)}
            side=9
            x,y=59,30
            facing=sw
            unrenamable=yes
        [/unit]

        [redraw][/redraw]

#ifndef EASY
        [delay]
            time=300
        [/delay]

        [sound]
            name=wail.wav
        [/sound]

        [unit]
            id=Górenas
            name= _ "Górenas"
            type=Elvish Warrior Spirit
            side=9
            x,y=61,33
            facing=nw
            unrenamable=yes
        [/unit]

        [redraw][/redraw]
#endif

        [message]
            speaker=Tyramos
            message= _ "Ugh…"
        [/message]

        [delay]
            time=100
        [/delay]

        {SET_FACING (id=Tyramos) se}

        # Move Tyramos to the scene...
        [teleport]
            [filter]
                id=Tyramos
            [/filter]
            animate=yes
            x,y=57,30
        [/teleport]
    [/event]

    # Tyrunio's defeat
    [event]
        name=tyurnio-defeat

        # Grab Tyurnio's coordinates
        [store_unit]
            variable=tcoor
            [filter]
                id=Tyurnio
            [/filter]
        [/store_unit]

        [message]
            speaker=Tyurnio
            message= _ "Ugh… You are indeed a worthy opponent… In addition, you don't seem like the other orcs… Please take this as a token of my apologies…"
        [/message]

        # A reward for the player
        {PICK_UP (items/ankh-necklace.png) $tcoor.x $tcoor.y
        ( _ "Eh? The necklace has a little scroll attached to the chain. Let's read it... 'Anyone who wears this artifact will have an immense amount of arcane energy flow through them, thus empowering any attacks that involve arcane energy. In addition, the wearer's resistance to arcane attacks will be heightened.'")
        (
            [object]
                id=arcane_pendant
                name= _ "Sublime Pendant of Arcanity"
                image=items/ankh-necklace.png
                duration=forever
                description= _ "The highly potent gem set in the pendant is a practically endless source of arcane energy, thus giving a 20% increase to the bearer's arcane attacks and providing a 20% increase to the bearer's arcane resistance."
                cannot_use_message= _ "This item is dangerous towards creatures composed of pure energy."
                [filter]
                    x,y=$tcoor.x,$tcoor.y
                    [not]
                        race=elemental
                    [/not]
                [/filter]
                [then]
                    [removeitem]
                        x,y=$tcoor.x,$tcoor.y
                        image=items/ankh-necklace.png
                    [/removeitem]
                [/then]
                [effect]
                    apply_to=attack
                    type=arcane
                    increase_damage=20%
                [/effect]
                [effect]
                    apply_to=resistance
                    replace=false
                    [resistance]
                        arcane=-20%
                    [/resistance]
                [/effect]
            [/object]
        )}

        [message]
            speaker="Sorum'tar"
            message= _ "Uh, thanks…"
        [/message]

        [message]
            speaker=Tyurnio
            message= _ "Use it well."
        [/message]

        [if]
            [have_unit]
                id=Galés
                [or]
                    id=Landor
                [/or]
#ifndef EASY
                [or]
                    id=Górenas
                [/or]
#endif
            [/have_unit]
            [then]
                [message]
                    speaker=Tyurnio
                    message= _ "Guards, all is well now; let us return to our eternal rest!"
                [/message]

                [kill]
                    id=Galés
                [/kill]

                [kill]
                    id=Landor
                [/kill]

#ifndef EASY
                [kill]
                    id=Górenas
                [/kill]
#endif
            [/then]
        [/if]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=Tyurnio
            message= _ "And now, I bid all of you adieu."
        [/message]

        # An aid for 'throw'
        [kill]
            id=Tyurnio
            animate=yes
        [/kill]
    [/event]

    #############################
    #        Victory!           #
    #############################
    [event]
        name=victory

        # Grab Ameriälis' coordinates
        # The [if] codeblock is there to prevent
        # a stupid error from occurring in scenario three
        # if 'victory' is triggered before Mal Ameriälis is spawned.
        [if]
            [have_unit]
                id=Mal Ameriälis
            [/have_unit]
            [then]
                [store_unit]
                    variable=astore
                    [filter]
                        id=Mal Ameriälis
                    [/filter]
                [/store_unit]
            [/then]
        [/if]

        [message]
            speaker=second_unit
            message= _ "Die, you cruel witch!"
        [/message]

        [message]
            speaker=unit
            sound=lich-die.ogg
            message= _ "Aghhhhhhhhhhhhhhhheeeeeeeeeeeeaaaaaaaa!"
        [/message]

        [kill]
            id=Mal Ameriälis
        [/kill]

        [sound]
            name=wail.wav
        [/sound]

        [unit]
            side=7
            id=Ameriälis
            name= _ "Ameriälis"
            type=Elvish Sylph Spirit
            x=$astore.x
            y=$astore.y
            facing=$astore.facing
            side=7
            canrecruit=yes
            [modifications]
                {TRAIT_DEXTROUS}
            [/modifications]
        [/unit]

        [message]
            speaker=Ameriälis
            message= _ "… … … Thank you… for freeing me… from that spell…"
        [/message]

        [message]
            speaker=second_unit
            message= _ "… Who are you?"
        [/message]

        [message]
            speaker=Ameriälis
            message={WHISPER _"You will be told very soon, my savior…"}
        [/message]

        [message]
            speaker=Ameriälis
            message= _ "Now… creatures of the afterlife being held here by my will, return to the afterlife!"
        [/message]

        # "Kill" all of side seven's undead
        [kill]
            race=undead
            side=7
            [or]
                race=elvish_spirits
                side=7
            [/or]
            [not]
                id=Ameriälis
            [/not]
            animate=yes
        [/kill]

        [kill]
            id=Ameriälis
        [/kill]

        [sound]
            name=wail-long.wav
        [/sound]

        # Insert dialogue here...

        # Clear variables that will never be touched again...

        [clear_variable]
            name=astore
        [/clear_variable]

        [clear_variable]
            name=tcoor
        [/clear_variable]

        # End the level
        {ENDLEVEL_VICTORY no 40}
    [/event]
[/scenario]
